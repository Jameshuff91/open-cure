======================================================================
h393: Holdout Validation of All Tier Rules (Overfitting Audit)
======================================================================

Loading predictor...
Loaded 3609 GT diseases, 58016 pairs
Diseases with GT + embeddings: 455

--- FULL-DATA BASELINE (no holdout) ---
Evaluated 455 diseases, 13622 predictions

Full-data tier precision:
  GOLDEN: 66.1% (121/183)
  HIGH: 53.9% (286/531)
  MEDIUM: 26.8% (881/3290)
  LOW: 13.8% (424/3073)
  FILTER: 10.5% (687/6545)

======================================================================
SEED 42 (1/5)
======================================================================
Train: 364, Holdout: 91
Holdout: 91 diseases, 2726 predictions

Holdout tier precision:
  GOLDEN: 36.8% (7/19)
  HIGH: 42.0% (29/69)
  MEDIUM: 23.2% (103/444)
  LOW: 12.7% (92/724)
  FILTER: 6.3% (93/1470)

======================================================================
SEED 123 (2/5)
======================================================================
Train: 364, Holdout: 91
Holdout: 91 diseases, 2728 predictions

Holdout tier precision:
  GOLDEN: 61.8% (21/34)
  HIGH: 54.6% (53/97)
  MEDIUM: 22.8% (140/615)
  LOW: 11.3% (68/604)
  FILTER: 8.1% (111/1378)

======================================================================
SEED 456 (3/5)
======================================================================
Train: 364, Holdout: 91
Holdout: 91 diseases, 2716 predictions

Holdout tier precision:
  GOLDEN: 57.7% (15/26)
  HIGH: 61.3% (49/80)
  MEDIUM: 22.0% (141/641)
  LOW: 13.2% (80/606)
  FILTER: 7.7% (105/1363)

======================================================================
SEED 789 (4/5)
======================================================================
Train: 364, Holdout: 91
Holdout: 91 diseases, 2725 predictions

Holdout tier precision:
  GOLDEN: 62.5% (5/8)
  HIGH: 50.0% (37/74)
  MEDIUM: 28.3% (179/633)
  LOW: 16.2% (113/696)
  FILTER: 9.6% (126/1314)

======================================================================
SEED 2024 (5/5)
======================================================================
Train: 364, Holdout: 91
Holdout: 91 diseases, 2727 predictions

Holdout tier precision:
  GOLDEN: 90.9% (20/22)
  HIGH: 52.1% (63/121)
  MEDIUM: 20.5% (114/556)
  LOW: 9.5% (59/618)
  FILTER: 9.4% (132/1410)

======================================================================
AGGREGATE HOLDOUT RESULTS (mean ± std across 5 seeds)
======================================================================

--- TIER PRECISION: Full-Data vs Holdout ---
  GOLDEN  : Full= 66.1% | Holdout= 61.9% ± 17.3% | Delta= -4.2pp
  HIGH    : Full= 53.9% | Holdout= 52.0% ±  6.3% | Delta= -1.9pp
  MEDIUM  : Full= 26.8% | Holdout= 23.4% ±  2.6% | Delta= -3.4pp
  LOW     : Full= 13.8% | Holdout= 12.6% ±  2.2% | Delta= -1.2pp
  FILTER  : Full= 10.5% | Holdout=  8.2% ±  1.2% | Delta= -2.3pp

--- SUCCESS CRITERIA ---
GOLDEN holdout precision > 30%: PASS (61.9%)
Tier ordering (GOLDEN > HIGH > MEDIUM > LOW > FILTER): PASS
  Values: GOLDEN=61.9% > HIGH=52.0% > MEDIUM=23.4% > LOW=12.6% > FILTER=8.2%

--- PER-RULE HOLDOUT ANALYSIS ---
Rule                                     Tier      Full%  Hold%  ±std      Δ     n Status      
----------------------------------------------------------------------------------------------------
  default                                FILTER    13.8%  11.4% ± 1.3  -2.4   1922 GENUINE
  complication_non_validated             FILTER    14.5%   3.3% ± 4.3 -11.2     10 degraded
  inverse_indication                     FILTER     3.4%   8.3% ±14.4  +4.9      3 GENUINE
  cross_domain_isolated                  FILTER    10.3%  10.2% ± 1.9  -0.1     65 GENUINE
  base_to_complication                   FILTER    15.6%  10.0% ±10.0  -5.6      6 degraded
  cancer_no_gt                           FILTER     4.5%   6.3% ± 3.9  +1.8     72 GENUINE
  corticosteroid_iatrogenic              FILTER    16.7%  37.9% ±37.8 +21.2      6 GENUINE
  cancer_only_non_cancer                 FILTER    14.3%   3.6% ± 6.2 -10.7      8 degraded
  statin_cv_event                        GOLDEN    40.0%   0.0% ± 0.0 -40.0      0 small-n
  metabolic_hierarchy_lipid              GOLDEN    55.6%  38.0% ± 8.5 -17.6     14 OVERFITTED?
  neurological_hierarchy_epilepsy        GOLDEN    50.0%   0.0% ± 0.0 -50.0      0 OVERFITTED?
  neurological_hierarchy_alzheimers      GOLDEN    50.0%   0.0% ± 0.0 -50.0      0 small-n
  metabolic_hierarchy_obesity            GOLDEN    42.9%   0.0% ± 0.0 -42.9      0 small-n
  neurological_hierarchy_neuropathy      GOLDEN    50.0%   0.0% ± 0.0 -50.0      0 small-n
  cardiovascular_hierarchy_heart_failure HIGH       0.0%   0.0% ± 0.0  +0.0      1 small-n
  incoherent_demotion                    HIGH      34.0%  46.1% ± 5.6 +12.1     70 GENUINE
  cardiovascular_hierarchy_hypertension  HIGH      54.1%  38.0% ±38.8 -16.1      6 OVERFITTED?
  comp_to_base_high_87                   HIGH      30.4%  28.9% ±32.9  -1.5      8 GENUINE
  metabolic_hierarchy_diabetes           HIGH      46.0%  38.9% ±28.3  -7.1      6 degraded
  autoimmune_hierarchy_multiple_sclerosis HIGH      66.7%   0.0% ± 0.0 -66.7      0 OVERFITTED?
  cardiovascular_hierarchy_atherosclerosis HIGH      16.7%   0.0% ± 0.0 -16.7      1 small-n
  cardiovascular_hierarchy_arrhythmia    HIGH      78.3%  68.2% ± 7.3 -10.1     12 degraded
  infectious_hierarchy_uti               HIGH      75.0%   0.0% ± 0.0 -75.0      0 OVERFITTED?
  cardiovascular_hierarchy_coronary      HIGH      33.3%  18.7% ± 4.4 -14.6     14 degraded
  autoimmune_hierarchy_rheumatoid_arthritis HIGH      80.8%  74.5% ± 3.9  -6.3     25 degraded
  metabolic_hierarchy_thyroid            HIGH      22.7%  21.1% ± 9.5  -1.6      6 GENUINE
  autoimmune_hierarchy_spondylitis       HIGH      80.0%   0.0% ± 0.0 -80.0      0 OVERFITTED?
  autoimmune_hierarchy_lupus             HIGH      85.7%   0.0% ± 0.0 -85.7      0 OVERFITTED?
  respiratory_hierarchy_asthma           HIGH      70.0%   0.0% ± 0.0 -70.0      0 OVERFITTED?
  infectious_hierarchy_tuberculosis      HIGH      62.9%  65.6% ±12.3  +2.7     10 GENUINE
  autoimmune_hierarchy_colitis           HIGH      70.6%  66.7% ± 0.0  -3.9      6 GENUINE
  reproductive                           HIGH      16.7%   0.0% ± 0.0 -16.7      3 small-n
  gastrointestinal                       HIGH     100.0% 100.0% ± 0.0  +0.0      2 small-n
  neurological                           HIGH      80.0% 100.0% ± 0.0 +20.0      1 small-n
  respiratory_hierarchy_copd             HIGH      75.0%   0.0% ± 0.0 -75.0      0 small-n
  infectious_hierarchy_respiratory_infection HIGH      83.3%   0.0% ± 0.0 -83.3      0 small-n
  infectious_hierarchy_sepsis            HIGH      50.0%   0.0% ± 0.0 -50.0      0 small-n
  autoimmune_hierarchy_scleroderma       HIGH      50.0%   0.0% ± 0.0 -50.0      0 small-n
  broad_class_isolated                   LOW        9.1%   3.2% ± 4.2  -5.9     18 degraded
  neurological_medium_demotion           LOW       10.6%   4.1% ± 4.9  -6.5     28 degraded
  gastrointestinal_medium_demotion       LOW       11.3%   4.7% ± 3.4  -6.6     55 degraded
  cancer                                 LOW       11.1%  13.7% ± 2.6  +2.6     77 GENUINE
  immunological_medium_demotion          LOW       26.1%   6.6% ± 7.3 -19.5     19 OVERFITTED?
  reproductive_medium_demotion           LOW       11.9%   2.9% ± 0.0  -9.0     35 degraded
  mechanism_specific                     LOW       13.1%   6.7% ± 9.4  -6.4     26 degraded
  cv_pathway_comprehensive               MEDIUM    36.8%  29.1% ±16.7  -7.7     16 degraded
  target_overlap_promotion               MEDIUM    48.0%  37.4% ± 1.7 -10.6     55 degraded
  cancer_same_type                       MEDIUM    24.9%  19.7% ± 2.9  -5.2    163 degraded
  cardiovascular                         MEDIUM    26.8%  38.2% ±19.1 +11.4     12 GENUINE
  respiratory                            MEDIUM    40.0%  36.0% ±11.8  -4.0      9 GENUINE
  hematological                          MEDIUM    30.1%  23.6% ±21.6  -6.5     25 degraded
  infectious_hierarchy_pneumonia         MEDIUM    53.3%   0.0% ± 0.0 -53.3      6 OVERFITTED?
  metabolic                              MEDIUM    11.8%   8.3% ±14.4  -3.5      5 GENUINE
  highly_repurposable                    MEDIUM    33.3%  25.9% ±30.7  -7.4      5 degraded
  neurological_hierarchy_parkinsons      MEDIUM     0.0%   0.0% ± 0.0  -0.0      0 small-n
  neurological_hierarchy_migraine        MEDIUM     0.0%   0.0% ± 0.0  -0.0      0 small-n

--- OVERFITTED RULES (holdout drops >15pp, n>=10) ---
  metabolic_hierarchy_lipid: Full=55.6% → Holdout=38.0% (Δ=-17.6pp, n=63)
  neurological_hierarchy_epilepsy: Full=50.0% → Holdout=0% (Δ=-50.0pp, n=16)
  cardiovascular_hierarchy_hypertension: Full=54.1% → Holdout=38.0% (Δ=-16.2pp, n=37)
  autoimmune_hierarchy_multiple_sclerosis: Full=66.7% → Holdout=0% (Δ=-66.7pp, n=15)
  infectious_hierarchy_uti: Full=75.0% → Holdout=0% (Δ=-75.0pp, n=16)
  autoimmune_hierarchy_spondylitis: Full=80.0% → Holdout=0% (Δ=-80.0pp, n=20)
  autoimmune_hierarchy_lupus: Full=85.7% → Holdout=0% (Δ=-85.7pp, n=14)
  respiratory_hierarchy_asthma: Full=70.0% → Holdout=0% (Δ=-70.0pp, n=20)
  immunological_medium_demotion: Full=26.1% → Holdout=6.6% (Δ=-19.5pp, n=69)
  infectious_hierarchy_pneumonia: Full=53.3% → Holdout=0.0% (Δ=-53.3pp, n=15)

--- SUMMARY ---
Rules tested: 56
  GENUINE (Δ > -5pp, n>=10): 14
  Degraded (-15pp < Δ < -5pp, n>=10): 17
  OVERFITTED? (Δ < -15pp, n>=10): 10
  Small sample (n<10): 15

Results saved to /Users/jimhuff/github/open-cure/data/analysis/h393_holdout_validation.json
