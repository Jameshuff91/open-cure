======================================================================
h393: Holdout Validation of All Tier Rules (Overfitting Audit)
======================================================================

Loading predictor...
Loaded 3609 GT diseases, 58016 pairs
Diseases with GT + embeddings: 455

--- FULL-DATA BASELINE (no holdout) ---
Evaluated 455 diseases, 13622 predictions

Full-data tier precision:
  GOLDEN: 65.4% (123/188)
  HIGH: 54.7% (284/519)
  MEDIUM: 26.7% (878/3285)
  LOW: 13.7% (421/3083)
  FILTER: 10.6% (696/6547)

======================================================================
SEED 42 (1/5)
======================================================================
Train: 364, Holdout: 91
Holdout: 91 diseases, 2726 predictions

Holdout tier precision:
  GOLDEN: 36.8% (7/19)
  HIGH: 41.8% (28/67)
  MEDIUM: 22.4% (100/446)
  LOW: 12.5% (91/727)
  FILTER: 6.7% (99/1467)

======================================================================
SEED 123 (2/5)
======================================================================
Train: 364, Holdout: 91
Holdout: 91 diseases, 2728 predictions

Holdout tier precision:
  GOLDEN: 65.7% (23/35)
  HIGH: 55.2% (53/96)
  MEDIUM: 22.3% (136/611)
  LOW: 11.3% (69/608)
  FILTER: 8.1% (111/1378)

======================================================================
SEED 456 (3/5)
======================================================================
Train: 364, Holdout: 91
Holdout: 91 diseases, 2716 predictions

Holdout tier precision:
  GOLDEN: 57.7% (15/26)
  HIGH: 60.8% (48/79)
  MEDIUM: 21.7% (140/644)
  LOW: 13.0% (79/610)
  FILTER: 8.0% (108/1357)

======================================================================
SEED 789 (4/5)
======================================================================
Train: 364, Holdout: 91
Holdout: 91 diseases, 2725 predictions

Holdout tier precision:
  GOLDEN: 75.0% (6/8)
  HIGH: 52.1% (37/71)
  MEDIUM: 27.9% (175/627)
  LOW: 16.2% (114/704)
  FILTER: 9.3% (122/1315)

======================================================================
SEED 2024 (5/5)
======================================================================
Train: 364, Holdout: 91
Holdout: 91 diseases, 2727 predictions

Holdout tier precision:
  GOLDEN: 90.5% (19/21)
  HIGH: 52.1% (63/121)
  MEDIUM: 20.7% (115/555)
  LOW: 9.7% (60/616)
  FILTER: 9.4% (133/1414)

======================================================================
AGGREGATE HOLDOUT RESULTS (mean ± std across 5 seeds)
======================================================================

--- TIER PRECISION: Full-Data vs Holdout ---
  GOLDEN  : Full= 65.4% | Holdout= 65.1% ± 17.9% | Delta= -0.3pp
  HIGH    : Full= 54.7% | Holdout= 52.4% ±  6.2% | Delta= -2.3pp
  MEDIUM  : Full= 26.7% | Holdout= 23.0% ±  2.5% | Delta= -3.7pp
  LOW     : Full= 13.7% | Holdout= 12.5% ±  2.2% | Delta= -1.2pp
  FILTER  : Full= 10.6% | Holdout=  8.3% ±  1.0% | Delta= -2.3pp

--- SUCCESS CRITERIA ---
GOLDEN holdout precision > 30%: PASS (65.1%)
Tier ordering (GOLDEN > HIGH > MEDIUM > LOW > FILTER): PASS
  Values: GOLDEN=65.1% > HIGH=52.4% > MEDIUM=23.0% > LOW=12.5% > FILTER=8.3%

--- PER-RULE HOLDOUT ANALYSIS ---
Rule                                     Tier      Full%  Hold%  ±std      Δ     n Status      
----------------------------------------------------------------------------------------------------
  default                                FILTER    14.0%  11.4% ± 1.2  -2.6   1919 GENUINE
  complication_non_validated             FILTER    13.2%   3.4% ± 4.5  -9.8     10 degraded
  inverse_indication                     FILTER     3.4%   8.3% ±14.4  +4.9      3 GENUINE
  cross_domain_isolated                  FILTER     9.5%  10.0% ± 2.1  +0.5     64 GENUINE
  base_to_complication                   FILTER    15.6%  10.0% ±10.0  -5.6      6 degraded
  cancer_no_gt                           FILTER     4.6%   6.5% ± 4.2  +1.9     72 GENUINE
  corticosteroid_iatrogenic              FILTER    16.7%  37.9% ±37.8 +21.2      6 GENUINE
  cancer_only_non_cancer                 FILTER    14.3%   3.6% ± 6.2 -10.7      8 degraded
  statin_cv_event                        GOLDEN    50.0%   0.0% ± 0.0 -50.0      0 small-n
  metabolic_hierarchy_lipid              GOLDEN    53.8%  41.7% ± 6.8 -12.1     14 degraded
  respiratory_hierarchy_asthma           GOLDEN    75.0%   0.0% ± 0.0 -75.0      0 OVERFITTED?
  neurological_hierarchy_epilepsy        GOLDEN    50.0%   0.0% ± 0.0 -50.0      0 OVERFITTED?
  neurological_hierarchy_alzheimers      GOLDEN    50.0%   0.0% ± 0.0 -50.0      0 small-n
  metabolic_hierarchy_obesity            GOLDEN    42.9%   0.0% ± 0.0 -42.9      0 small-n
  neurological_hierarchy_neuropathy      GOLDEN    50.0%   0.0% ± 0.0 -50.0      0 small-n
  cardiovascular_hierarchy_heart_failure HIGH       0.0%   0.0% ± 0.0  +0.0      1 small-n
  incoherent_demotion                    HIGH      33.3%  45.7% ± 6.6 +12.4     71 GENUINE
  cardiovascular_hierarchy_hypertension  HIGH      54.3%  41.1% ±41.3 -13.2      6 degraded
  comp_to_base_high_87                   HIGH      31.8%  28.9% ±32.9  -2.9      7 GENUINE
  metabolic_hierarchy_diabetes           HIGH      51.0%  38.9% ±28.3 -12.1      6 degraded
  autoimmune_hierarchy_multiple_sclerosis HIGH      69.2%   0.0% ± 0.0 -69.2      0 OVERFITTED?
  cardiovascular_hierarchy_atherosclerosis HIGH      16.7%   0.0% ± 0.0 -16.7      1 small-n
  cardiovascular_hierarchy_arrhythmia    HIGH      76.1%  67.2% ± 6.1  -8.9     12 degraded
  infectious_hierarchy_uti               HIGH      75.0%   0.0% ± 0.0 -75.0      0 OVERFITTED?
  cardiovascular_hierarchy_coronary      HIGH      33.3%  19.6% ± 5.3 -13.6     13 degraded
  autoimmune_hierarchy_rheumatoid_arthritis HIGH      83.1%  73.4% ± 4.6  -9.7     26 degraded
  metabolic_hierarchy_thyroid            HIGH      22.7%  21.1% ± 9.5  -1.6      6 GENUINE
  autoimmune_hierarchy_spondylitis       HIGH      80.0%   0.0% ± 0.0 -80.0      0 OVERFITTED?
  autoimmune_hierarchy_lupus             HIGH      85.7%   0.0% ± 0.0 -85.7      0 OVERFITTED?
  infectious_hierarchy_tuberculosis      HIGH      62.9%  65.6% ±12.3  +2.7     10 GENUINE
  autoimmune_hierarchy_colitis           HIGH      68.6%  71.4% ± 0.0  +2.8      7 GENUINE
  reproductive                           HIGH      16.7%   0.0% ± 0.0 -16.7      3 small-n
  gastrointestinal                       HIGH     100.0% 100.0% ± 0.0  +0.0      2 small-n
  neurological                           HIGH      80.0% 100.0% ± 0.0 +20.0      1 small-n
  respiratory_hierarchy_copd             HIGH      75.0%   0.0% ± 0.0 -75.0      0 small-n
  infectious_hierarchy_respiratory_infection HIGH      83.3%   0.0% ± 0.0 -83.3      0 small-n
  infectious_hierarchy_sepsis            HIGH      50.0%   0.0% ± 0.0 -50.0      0 small-n
  autoimmune_hierarchy_scleroderma       HIGH      50.0%   0.0% ± 0.0 -50.0      0 small-n
  broad_class_isolated                   LOW        7.3%   3.0% ± 3.8  -4.3     19 GENUINE
  neurological_medium_demotion           LOW       10.1%   3.7% ± 4.3  -6.4     30 degraded
  gastrointestinal_medium_demotion       LOW       11.4%   4.7% ± 3.4  -6.7     56 degraded
  cancer                                 LOW       10.6%  13.0% ± 2.4  +2.4     77 GENUINE
  immunological_medium_demotion          LOW       25.0%   6.6% ± 7.3 -18.4     19 OVERFITTED?
  reproductive_medium_demotion           LOW       11.9%   2.9% ± 0.0  -9.0     34 degraded
  mechanism_specific                     LOW       12.3%   6.9% ± 9.8  -5.4     26 degraded
  cv_pathway_comprehensive               MEDIUM    36.4%  29.4% ±16.5  -7.0     16 degraded
  target_overlap_promotion               MEDIUM    44.9%  32.6% ± 2.0 -12.3     56 degraded
  cancer_same_type                       MEDIUM    25.3%  19.7% ± 2.6  -5.6    163 degraded
  cardiovascular                         MEDIUM    29.7%  31.4% ±24.8  +1.7     12 GENUINE
  respiratory                            MEDIUM    30.0%  37.4% ±13.7  +7.4      9 GENUINE
  hematological                          MEDIUM    29.4%  23.7% ±21.5  -5.7     24 degraded
  metabolic                              MEDIUM     5.9%   4.2% ± 7.2  -1.7      4 GENUINE
  infectious_hierarchy_pneumonia         MEDIUM    53.3%   0.0% ± 0.0 -53.3      6 OVERFITTED?
  highly_repurposable                    MEDIUM    33.3%  27.1% ±32.7  -6.1      5 degraded
  neurological_hierarchy_parkinsons      MEDIUM     0.0%   0.0% ± 0.0  -0.0      0 small-n
  neurological_hierarchy_migraine        MEDIUM     0.0%   0.0% ± 0.0  -0.0      0 small-n

--- OVERFITTED RULES (holdout drops >15pp, n>=10) ---
  respiratory_hierarchy_asthma: Full=75.0% → Holdout=0% (Δ=-75.0pp, n=20)
  neurological_hierarchy_epilepsy: Full=50.0% → Holdout=0% (Δ=-50.0pp, n=16)
  autoimmune_hierarchy_multiple_sclerosis: Full=69.2% → Holdout=0% (Δ=-69.2pp, n=13)
  infectious_hierarchy_uti: Full=75.0% → Holdout=0% (Δ=-75.0pp, n=16)
  autoimmune_hierarchy_spondylitis: Full=80.0% → Holdout=0% (Δ=-80.0pp, n=20)
  autoimmune_hierarchy_lupus: Full=85.7% → Holdout=0% (Δ=-85.7pp, n=14)
  immunological_medium_demotion: Full=25.0% → Holdout=6.6% (Δ=-18.4pp, n=72)
  infectious_hierarchy_pneumonia: Full=53.3% → Holdout=0.0% (Δ=-53.3pp, n=15)

--- SUMMARY ---
Rules tested: 56
  GENUINE (Δ > -5pp, n>=10): 15
  Degraded (-15pp < Δ < -5pp, n>=10): 18
  OVERFITTED? (Δ < -15pp, n>=10): 8
  Small sample (n<10): 15

Results saved to /Users/jimhuff/github/open-cure/data/analysis/h393_holdout_validation.json
