======================================================================
h393: Holdout Validation of All Tier Rules (Overfitting Audit)
======================================================================

Loading predictor...
Loaded 3638 GT diseases, 59519 pairs
Diseases with GT + embeddings: 455

--- FULL-DATA BASELINE (no holdout) ---
Evaluated 455 diseases, 13622 predictions

Full-data tier precision:
  GOLDEN: 89.2% (165/185)
  HIGH: 76.8% (398/518)
  MEDIUM: 40.5% (1334/3293)
  LOW: 21.4% (660/3091)
  FILTER: 16.8% (1095/6535)

======================================================================
SEED 42 (1/5)
======================================================================
Train: 364, Holdout: 91
Holdout: 91 diseases, 2726 predictions

Holdout tier precision:
  GOLDEN: 31.6% (6/19)
  HIGH: 49.3% (35/71)
  MEDIUM: 28.9% (129/446)
  LOW: 14.9% (108/727)
  FILTER: 8.7% (128/1463)

======================================================================
SEED 123 (2/5)
======================================================================
Train: 364, Holdout: 91
Holdout: 91 diseases, 2728 predictions

Holdout tier precision:
  GOLDEN: 63.6% (21/33)
  HIGH: 67.3% (66/98)
  MEDIUM: 31.8% (194/610)
  LOW: 13.4% (82/612)
  FILTER: 10.2% (140/1375)

======================================================================
SEED 456 (3/5)
======================================================================
Train: 364, Holdout: 91
Holdout: 91 diseases, 2716 predictions

Holdout tier precision:
  GOLDEN: 73.1% (19/26)
  HIGH: 69.6% (55/79)
  MEDIUM: 29.2% (188/644)
  LOW: 16.1% (97/603)
  FILTER: 9.7% (132/1364)

======================================================================
SEED 789 (4/5)
======================================================================
Train: 364, Holdout: 91
Holdout: 91 diseases, 2725 predictions

Holdout tier precision:
  GOLDEN: 71.4% (5/7)
  HIGH: 59.7% (43/72)
  MEDIUM: 36.9% (233/632)
  LOW: 18.2% (125/687)
  FILTER: 11.5% (152/1327)

======================================================================
SEED 2024 (5/5)
======================================================================
Train: 364, Holdout: 91
Holdout: 91 diseases, 2727 predictions

Holdout tier precision:
  GOLDEN: 95.2% (20/21)
  HIGH: 58.0% (69/119)
  MEDIUM: 27.2% (152/558)
  LOW: 11.3% (69/613)
  FILTER: 11.4% (162/1416)

======================================================================
AGGREGATE HOLDOUT RESULTS (mean ± std across 5 seeds)
======================================================================

--- TIER PRECISION: Full-Data vs Holdout ---
  GOLDEN  : Full= 89.2% | Holdout= 67.0% ± 20.6% | Delta=-22.2pp
  HIGH    : Full= 76.8% | Holdout= 60.8% ±  7.2% | Delta=-16.0pp
  MEDIUM  : Full= 40.5% | Holdout= 30.8% ±  3.4% | Delta= -9.7pp
  LOW     : Full= 21.4% | Holdout= 14.8% ±  2.3% | Delta= -6.6pp
  FILTER  : Full= 16.8% | Holdout= 10.3% ±  1.1% | Delta= -6.5pp

--- SUCCESS CRITERIA ---
GOLDEN holdout precision > 30%: PASS (67.0%)
Tier ordering (GOLDEN > HIGH > MEDIUM > LOW > FILTER): PASS
  Values: GOLDEN=67.0% > HIGH=60.8% > MEDIUM=30.8% > LOW=14.8% > FILTER=10.3%

--- PER-RULE HOLDOUT ANALYSIS ---
Rule                                     Tier      Full%  Hold%  ±std      Δ     n Status      
----------------------------------------------------------------------------------------------------
  inverse_indication                     FILTER    19.0%  37.9% ±27.0 +18.9      5 GENUINE
  default                                FILTER    21.7%  15.0% ± 1.6  -6.7   1922 degraded
  complication_non_validated             FILTER    21.1%   3.2% ± 4.2 -17.9     11 OVERFITTED?
  cross_domain_isolated                  FILTER    10.5%  10.5% ± 1.6  -0.0     64 GENUINE
  base_to_complication                   FILTER    37.5%  10.0% ±10.0 -27.5      6 OVERFITTED?
  cancer_no_gt                           FILTER     5.8%   6.9% ± 3.4  +1.1     72 GENUINE
  corticosteroid_iatrogenic              FILTER    16.7%  37.9% ±37.8 +21.2      6 GENUINE
  cancer_only_non_cancer                 FILTER    15.8%   3.6% ± 6.2 -12.2      8 degraded
  statin_cv_event                        GOLDEN    75.0%   0.0% ± 0.0 -75.0      0 small-n
  metabolic_hierarchy_lipid              GOLDEN    81.0%  44.8% ±19.2 -36.2     13 OVERFITTED?
  respiratory_hierarchy_asthma           GOLDEN   100.0%   0.0% ± 0.0 -100.0      0 OVERFITTED?
  neurological_hierarchy_epilepsy        GOLDEN   100.0%   0.0% ± 0.0 -100.0      0 OVERFITTED?
  neurological_hierarchy_alzheimers      GOLDEN   100.0%   0.0% ± 0.0 -100.0      0 small-n
  metabolic_hierarchy_obesity            GOLDEN   100.0%   0.0% ± 0.0 -100.0      0 small-n
  neurological_hierarchy_neuropathy      GOLDEN    50.0%   0.0% ± 0.0 -50.0      0 small-n
  cardiovascular_hierarchy_heart_failure HIGH      50.0%   0.0% ± 0.0 -50.0      1 small-n
  incoherent_demotion                    HIGH      38.4%  53.5% ± 5.4 +15.1     71 GENUINE
  cardiovascular_hierarchy_hypertension  HIGH      85.3%  39.2% ±39.7 -46.1      6 OVERFITTED?
  comp_to_base_high_87                   HIGH      52.2%  33.9% ±40.8 -18.3      8 OVERFITTED?
  metabolic_hierarchy_diabetes           HIGH      87.0%  47.2% ±41.0 -39.8      6 OVERFITTED?
  autoimmune_hierarchy_multiple_sclerosis HIGH     100.0%   0.0% ± 0.0 -100.0      0 OVERFITTED?
  cardiovascular_hierarchy_atherosclerosis HIGH      83.3%   0.0% ± 0.0 -83.3      0 small-n
  cardiovascular_hierarchy_arrhythmia    HIGH      93.0%  74.1% ± 1.3 -18.9     11 OVERFITTED?
  infectious_hierarchy_uti               HIGH     100.0%   0.0% ± 0.0 -100.0      0 OVERFITTED?
  cardiovascular_hierarchy_coronary      HIGH      65.6%  33.5% ± 4.9 -32.0     14 OVERFITTED?
  autoimmune_hierarchy_rheumatoid_arthritis HIGH      94.9%  83.8% ±10.2 -11.1     25 degraded
  metabolic_hierarchy_thyroid            HIGH      50.0%  38.9% ±23.2 -11.1      6 degraded
  autoimmune_hierarchy_spondylitis       HIGH     100.0%   0.0% ± 0.0 -100.0      0 OVERFITTED?
  autoimmune_hierarchy_lupus             HIGH     100.0%   0.0% ± 0.0 -100.0      0 OVERFITTED?
  infectious_hierarchy_tuberculosis      HIGH      80.0%  71.2% ± 2.6  -8.8     10 degraded
  autoimmune_hierarchy_colitis           HIGH      94.3%  87.5% ± 0.0  -6.8      8 degraded
  reproductive                           HIGH      50.0%   0.0% ± 0.0 -50.0      3 small-n
  gastrointestinal                       HIGH     100.0% 100.0% ± 0.0  +0.0      3 small-n
  neurological                           HIGH      80.0% 100.0% ± 0.0 +20.0      1 small-n
  respiratory_hierarchy_copd             HIGH     100.0%   0.0% ± 0.0 -100.0      0 small-n
  infectious_hierarchy_respiratory_infection HIGH     100.0%   0.0% ± 0.0 -100.0      0 small-n
  infectious_hierarchy_sepsis            HIGH     100.0%   0.0% ± 0.0 -100.0      0 small-n
  autoimmune_hierarchy_scleroderma       HIGH     100.0%   0.0% ± 0.0 -100.0      0 small-n
  broad_class_isolated                   LOW       21.7%   7.1% ± 5.0 -14.6     18 degraded
  neurological_medium_demotion           LOW       16.5%   5.1% ± 3.7 -11.4     29 degraded
  gastrointestinal_medium_demotion       LOW       17.6%   5.2% ± 2.3 -12.4     56 degraded
  cancer                                 LOW       11.4%  14.6% ± 1.8  +3.2     77 GENUINE
  immunological_medium_demotion          LOW       30.6%   7.6% ± 6.9 -23.0     19 OVERFITTED?
  reproductive_medium_demotion           LOW       13.3%   2.9% ± 0.0 -10.4     35 degraded
  mechanism_specific                     LOW       17.0%   6.7% ± 9.4 -10.3     26 degraded
  cv_pathway_comprehensive               MEDIUM    69.5%  41.3% ± 8.6 -28.2     15 OVERFITTED?
  target_overlap_promotion               MEDIUM    58.7%  40.4% ± 3.7 -18.3     54 OVERFITTED?
  cancer_same_type                       MEDIUM    44.8%  24.2% ± 4.2 -20.6    163 OVERFITTED?
  cardiovascular                         MEDIUM    44.7%  37.8% ±19.1  -6.9     12 degraded
  respiratory                            MEDIUM    44.4%  42.4% ±14.9  -2.0      9 GENUINE
  hematological                          MEDIUM    30.5%  23.7% ±21.5  -6.8     24 degraded
  metabolic                              MEDIUM    10.8%   5.0% ± 8.7  -5.8      5 degraded
  infectious_hierarchy_pneumonia         MEDIUM    80.0%  16.7% ± 0.0 -63.3      6 OVERFITTED?
  highly_repurposable                    MEDIUM    33.3%  26.2% ±32.7  -7.0      5 degraded
  neurological_hierarchy_parkinsons      MEDIUM   100.0%   0.0% ± 0.0 -100.0      0 small-n
  neurological_hierarchy_migraine        MEDIUM   100.0%   0.0% ± 0.0 -100.0      0 small-n

--- OVERFITTED RULES (holdout drops >15pp, n>=10) ---
  complication_non_validated: Full=21.1% → Holdout=3.2% (Δ=-17.9pp, n=76)
  base_to_complication: Full=37.5% → Holdout=10.0% (Δ=-27.5pp, n=32)
  metabolic_hierarchy_lipid: Full=81.0% → Holdout=44.8% (Δ=-36.2pp, n=63)
  respiratory_hierarchy_asthma: Full=100.0% → Holdout=0% (Δ=-100.0pp, n=20)
  neurological_hierarchy_epilepsy: Full=100.0% → Holdout=0% (Δ=-100.0pp, n=16)
  cardiovascular_hierarchy_hypertension: Full=85.3% → Holdout=39.2% (Δ=-46.1pp, n=34)
  comp_to_base_high_87: Full=52.2% → Holdout=33.9% (Δ=-18.3pp, n=23)
  metabolic_hierarchy_diabetes: Full=87.0% → Holdout=47.2% (Δ=-39.8pp, n=46)
  autoimmune_hierarchy_multiple_sclerosis: Full=100.0% → Holdout=0% (Δ=-100.0pp, n=16)
  cardiovascular_hierarchy_arrhythmia: Full=93.0% → Holdout=74.1% (Δ=-18.9pp, n=43)
  infectious_hierarchy_uti: Full=100.0% → Holdout=0% (Δ=-100.0pp, n=16)
  cardiovascular_hierarchy_coronary: Full=65.6% → Holdout=33.6% (Δ=-32.0pp, n=32)
  autoimmune_hierarchy_spondylitis: Full=100.0% → Holdout=0% (Δ=-100.0pp, n=20)
  autoimmune_hierarchy_lupus: Full=100.0% → Holdout=0% (Δ=-100.0pp, n=14)
  immunological_medium_demotion: Full=30.6% → Holdout=7.6% (Δ=-23.0pp, n=72)
  cv_pathway_comprehensive: Full=69.5% → Holdout=41.3% (Δ=-28.2pp, n=105)
  target_overlap_promotion: Full=58.7% → Holdout=40.4% (Δ=-18.3pp, n=235)
  cancer_same_type: Full=44.8% → Holdout=24.2% (Δ=-20.6pp, n=1128)
  infectious_hierarchy_pneumonia: Full=80.0% → Holdout=16.7% (Δ=-63.3pp, n=15)

--- SUMMARY ---
Rules tested: 56
  GENUINE (Δ > -5pp, n>=10): 7
  Degraded (-15pp < Δ < -5pp, n>=10): 15
  OVERFITTED? (Δ < -15pp, n>=10): 19
  Small sample (n<10): 15

Results saved to /Users/jimhuff/github/open-cure/data/analysis/h393_holdout_validation.json
