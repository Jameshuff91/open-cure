======================================================================
h393: Holdout Validation of All Tier Rules (Overfitting Audit)
======================================================================

Loading predictor...
Loaded 3609 GT diseases, 58016 pairs
Diseases with GT + embeddings: 455

--- FULL-DATA BASELINE (no holdout) ---
Evaluated 455 diseases, 13622 predictions

Full-data tier precision:
  GOLDEN: 64.6% (122/189)
  HIGH: 51.8% (289/558)
  MEDIUM: 25.6% (933/3638)
  LOW: 13.1% (364/2769)
  FILTER: 10.6% (687/6468)

======================================================================
SEED 42 (1/5)
======================================================================
Train: 364, Holdout: 91
Holdout: 91 diseases, 2726 predictions

Holdout tier precision:
  GOLDEN: 47.4% (9/19)
  HIGH: 41.4% (29/70)
  MEDIUM: 23.6% (126/535)
  LOW: 10.3% (66/640)
  FILTER: 6.5% (95/1462)

======================================================================
SEED 123 (2/5)
======================================================================
Train: 364, Holdout: 91
Holdout: 91 diseases, 2728 predictions

Holdout tier precision:
  GOLDEN: 65.7% (23/35)
  HIGH: 54.5% (54/99)
  MEDIUM: 22.1% (157/709)
  LOW: 9.5% (49/517)
  FILTER: 7.8% (107/1368)

======================================================================
SEED 456 (3/5)
======================================================================
Train: 364, Holdout: 91
Holdout: 91 diseases, 2716 predictions

Holdout tier precision:
  GOLDEN: 57.7% (15/26)
  HIGH: 61.0% (50/82)
  MEDIUM: 20.7% (155/748)
  LOW: 12.1% (61/505)
  FILTER: 7.9% (107/1355)

======================================================================
SEED 789 (4/5)
======================================================================
Train: 364, Holdout: 91
Holdout: 91 diseases, 2725 predictions

Holdout tier precision:
  GOLDEN: 55.6% (5/9)
  HIGH: 47.9% (35/73)
  MEDIUM: 29.5% (213/721)
  LOW: 12.8% (77/603)
  FILTER: 9.2% (122/1319)

======================================================================
SEED 2024 (5/5)
======================================================================
Train: 364, Holdout: 91
Holdout: 91 diseases, 2727 predictions

Holdout tier precision:
  GOLDEN: 87.0% (20/23)
  HIGH: 50.8% (62/122)
  MEDIUM: 20.8% (134/644)
  LOW: 8.4% (45/538)
  FILTER: 9.1% (127/1400)

======================================================================
AGGREGATE HOLDOUT RESULTS (mean ± std across 5 seeds)
======================================================================

--- TIER PRECISION: Full-Data vs Holdout ---
  GOLDEN  : Full= 64.6% | Holdout= 62.7% ± 13.5% | Delta= -1.9pp
  HIGH    : Full= 51.8% | Holdout= 51.1% ±  6.5% | Delta= -0.7pp
  MEDIUM  : Full= 25.6% | Holdout= 23.3% ±  3.3% | Delta= -2.3pp
  LOW     : Full= 13.1% | Holdout= 10.6% ±  1.6% | Delta= -2.5pp
  FILTER  : Full= 10.6% | Holdout=  8.1% ±  1.0% | Delta= -2.5pp

--- SUCCESS CRITERIA ---
GOLDEN holdout precision > 30%: PASS (62.7%)
Tier ordering (GOLDEN > HIGH > MEDIUM > LOW > FILTER): PASS
  Values: GOLDEN=62.7% > HIGH=51.1% > MEDIUM=23.3% > LOW=10.6% > FILTER=8.1%

--- PER-RULE HOLDOUT ANALYSIS ---
Rule                                     Tier      Full%  Hold%  ±std      Δ     n Status      
----------------------------------------------------------------------------------------------------
  default                                FILTER    13.9%  11.3% ± 1.3  -2.6   1924 GENUINE
  complication_non_validated             FILTER    12.0%   4.5% ± 5.5  -7.5     10 degraded
  cross_domain_isolated                  FILTER    10.0%  10.2% ± 1.8  +0.2     65 GENUINE
  base_to_complication                   FILTER    15.6%  10.0% ±10.0  -5.6      6 degraded
  cancer_no_gt                           FILTER     4.8%   6.3% ± 3.9  +1.5     72 GENUINE
  cancer_only_non_cancer                 FILTER    14.3%   3.6% ± 6.2 -10.7      8 degraded
  statin_cv_event                        GOLDEN    40.0%   0.0% ± 0.0 -40.0      0 small-n
  metabolic_hierarchy_lipid              GOLDEN    53.8%  47.6% ± 1.7  -6.2     14 degraded
  neurological_hierarchy_epilepsy        GOLDEN    50.0%   0.0% ± 0.0 -50.0      0 OVERFITTED?
  neurological_hierarchy_alzheimers      GOLDEN    50.0%   0.0% ± 0.0 -50.0      0 small-n
  metabolic_hierarchy_obesity            GOLDEN    42.9%   0.0% ± 0.0 -42.9      0 small-n
  neurological_hierarchy_neuropathy      GOLDEN    50.0%   0.0% ± 0.0 -50.0      0 small-n
  cardiovascular_hierarchy_heart_failure HIGH       0.0%   0.0% ± 0.0  +0.0      1 small-n
  incoherent_demotion                    HIGH      33.7%  44.8% ± 7.2 +11.1     72 GENUINE
  cardiovascular_hierarchy_hypertension  HIGH      50.0%  33.4% ±36.5 -16.6      6 OVERFITTED?
  comp_to_base_high_87                   HIGH      31.8%  28.9% ±32.9  -2.9      7 GENUINE
  metabolic_hierarchy_diabetes           HIGH      32.4%  17.7% ±22.0 -14.7      5 degraded
  autoimmune_hierarchy_multiple_sclerosis HIGH      73.3%   0.0% ± 0.0 -73.3      0 OVERFITTED?
  cardiovascular_hierarchy_atherosclerosis HIGH      16.7%   0.0% ± 0.0 -16.7      0 small-n
  cardiovascular_hierarchy_arrhythmia    HIGH      76.6%  68.2% ± 7.3  -8.4     12 degraded
  infectious_hierarchy_uti               HIGH      75.0%   0.0% ± 0.0 -75.0      0 OVERFITTED?
  cardiovascular_hierarchy_coronary      HIGH      33.3%  19.1% ± 5.8 -14.1     14 degraded
  autoimmune_hierarchy_rheumatoid_arthritis HIGH      81.0%  74.8% ± 4.5  -6.2     25 degraded
  metabolic_hierarchy_thyroid            HIGH      23.1%  23.3% ± 7.2  +0.2      7 GENUINE
  autoimmune_hierarchy_spondylitis       HIGH      80.0%   0.0% ± 0.0 -80.0      0 OVERFITTED?
  autoimmune_hierarchy_lupus             HIGH      85.7%   0.0% ± 0.0 -85.7      0 OVERFITTED?
  respiratory_hierarchy_asthma           HIGH      70.0%   0.0% ± 0.0 -70.0      0 OVERFITTED?
  infectious_hierarchy_tuberculosis      HIGH      62.9%  65.6% ±12.3  +2.7     10 GENUINE
  autoimmune_hierarchy_colitis           HIGH      68.6%  57.1% ± 0.0 -11.5      7 degraded
  reproductive                           HIGH      16.7%   0.0% ± 0.0 -16.7      3 small-n
  gastrointestinal                       HIGH     100.0% 100.0% ± 0.0  +0.0      2 small-n
  neurological                           HIGH      80.0% 100.0% ± 0.0 +20.0      1 small-n
  respiratory_hierarchy_copd             HIGH      75.0%   0.0% ± 0.0 -75.0      0 small-n
  infectious_hierarchy_respiratory_infection HIGH      83.3%   0.0% ± 0.0 -83.3      0 small-n
  infectious_hierarchy_sepsis            HIGH      50.0%   0.0% ± 0.0 -50.0      0 small-n
  autoimmune_hierarchy_scleroderma       HIGH      50.0%   0.0% ± 0.0 -50.0      0 small-n
  broad_class_isolated                   LOW        9.7%   4.8% ± 4.2  -4.9     23 GENUINE
  neurological_medium_demotion           LOW        9.4%   3.5% ± 4.2  -5.9     30 degraded
  gastrointestinal_medium_demotion       LOW       10.8%   4.3% ± 2.8  -6.5     56 degraded
  immunological_medium_demotion          LOW       25.4%   6.6% ± 7.3 -18.8     19 OVERFITTED?
  reproductive_medium_demotion           LOW       10.9%   2.9% ± 0.0  -8.0     34 degraded
  mechanism_specific                     LOW       10.2%   7.5% ±10.7  -2.7     26 GENUINE
  cv_pathway_comprehensive               MEDIUM    35.6%  29.4% ±16.5  -6.2     16 degraded
  target_overlap_promotion               MEDIUM    46.6%  35.4% ± 1.9 -11.2     57 degraded
  cancer_same_type                       MEDIUM    25.1%  19.9% ± 2.9  -5.2    163 degraded
  cardiovascular                         MEDIUM    30.0%  38.0% ±21.9  +8.0     13 GENUINE
  cancer                                 MEDIUM    10.8%  13.1% ± 2.1  +2.3     75 GENUINE
  respiratory                            MEDIUM    38.1%  37.4% ±13.7  -0.7      9 GENUINE
  hematological                          MEDIUM    30.1%  26.8% ±24.8  -3.3     22 GENUINE
  infectious_hierarchy_pneumonia         MEDIUM    53.3%   0.0% ± 0.0 -53.3      6 OVERFITTED?
  metabolic                              MEDIUM    10.7%   7.2% ±12.4  -3.5      4 GENUINE
  highly_repurposable                    MEDIUM    22.2%  29.2% ±41.5  +7.0      4 small-n
  neurological_hierarchy_parkinsons      MEDIUM     0.0%   0.0% ± 0.0  -0.0      0 small-n
  neurological_hierarchy_migraine        MEDIUM     0.0%   0.0% ± 0.0  -0.0      0 small-n

--- OVERFITTED RULES (holdout drops >15pp, n>=10) ---
  neurological_hierarchy_epilepsy: Full=50.0% → Holdout=0% (Δ=-50.0pp, n=16)
  cardiovascular_hierarchy_hypertension: Full=50.0% → Holdout=33.4% (Δ=-16.6pp, n=36)
  autoimmune_hierarchy_multiple_sclerosis: Full=73.3% → Holdout=0% (Δ=-73.3pp, n=15)
  infectious_hierarchy_uti: Full=75.0% → Holdout=0% (Δ=-75.0pp, n=16)
  autoimmune_hierarchy_spondylitis: Full=80.0% → Holdout=0% (Δ=-80.0pp, n=20)
  autoimmune_hierarchy_lupus: Full=85.7% → Holdout=0% (Δ=-85.7pp, n=14)
  respiratory_hierarchy_asthma: Full=70.0% → Holdout=0% (Δ=-70.0pp, n=20)
  immunological_medium_demotion: Full=25.4% → Holdout=6.6% (Δ=-18.8pp, n=71)
  infectious_hierarchy_pneumonia: Full=53.3% → Holdout=0.0% (Δ=-53.3pp, n=15)

--- SUMMARY ---
Rules tested: 54
  GENUINE (Δ > -5pp, n>=10): 14
  Degraded (-15pp < Δ < -5pp, n>=10): 15
  OVERFITTED? (Δ < -15pp, n>=10): 9
  Small sample (n<10): 16

Results saved to /Users/jimhuff/github/open-cure/data/analysis/h393_holdout_validation.json
